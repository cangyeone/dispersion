# Extract Rayleigh Wave Phase Dispersion Curves from Noise Cross-correlation Functions
Extracting meaningful information from large seismic datasets often requires estimating the uncertainty associated with the results for quantitative analysis. This uncertainty arises from both the raw data and the manually labeled annotations. We introduce an uncertainty estimation framework designed to calculate the uncertainty from manually labeled data. This framework can efficiently output the true posterior from large datasets. We apply the framework to extract Rayleigh wave phase velocity dispersion and compute the posterior distribution of the dispersion results. We utilize 62,899 noise cross-correlation function (NCF) data from 438 stations located in Yunnan Province and manually label the Rayleigh phase velocity dispersion curves. Dispersion curve extraction presents two key challenges: (1) Researchers typically derive dispersion curves from spectrograms in the periodâ€“velocity domain, limiting the ability to directly study the relationship between NCFs and dispersion curves; (2) Assessing uncertainty in manually labeled data remains difficult. To address these challenges, the framework takes the NCFs as input and directly output both the dispersion values and the posterior of the dispersion values when processing the NCF data. This approach allows us to construct a flexible deep neural network (DNN) architecture that balances accuracy and computational efficiency.

### Train 
The training code is in the train.py and the datas are generated by EGFAnalysis.m by Yao. 

### Infer 
You can run makepicker.py to make the infer model for process single data. 
The extract_demo.py is used to extract dispersion curves from the infer model. 
The output format can be :
```text
velocity,filtered,standerd deviation
2.9718,False,0.0431
2.9859,False,0.0426
3.0122,False,0.0433
```

### Contact 
You can contact me at cangye@hotmail.com

### Citation
A Framework for Uncertainty Estimation in Seismology Data Processing with Application to Extract Rayleigh Wave Dispersion Curves from Noise Cross-correlation Functions

### License
GPLv3